name: Public Benchmark Suite (op-geth + TreeDB, storage-focused)
description: |
  Runs a storage-focused subset of the public benchmark workloads on op-geth with TreeDB enabled.

  This is intended to be used alongside `public-benchmark.yml` (reth + op-geth leveldb)
  to enable apples-to-apples comparisons on normalized hardware.

payloads:
  - name: Simulator
    id: base-mainnet-simulation
    type: simulator
    account_loaded: 12.382
    account_deleted: 0.0127
    accounts_updated: 4.6117
    accounts_created: 0.16
    storage_loaded: 49.405
    storage_deleted: 0.4651
    storage_updated: 9.439
    storage_created: 2
    code_size_loaded: 662473.15
    num_contracts_loaded: 4.330
    avg_gas_used: 35000000
    calls_per_block: 100
    opcodes:
      EXP: 626.30
      KECCAK256: 29.21
    precompiles:
      bls12381MapG2: 0.6981
      ecrecover: 0.0733
      bls12381G1Add: 0.0244
      bls12381G1MultiExp: 0.0218
  - name: storage create (full block)
    id: storage-create-full-block
    type: simulator
    storage_created: 100
  - name: storage update (full block)
    id: storage-update-full-block
    type: simulator
    storage_updated: 100
  - name: storage churn (create+delete full block)
    id: storage-churn-full-block
    type: simulator
    storage_created: 100
    storage_deleted: 100

benchmarks:
  - metrics:
      warning:
        sequencer/latency/get_payload: 1000000000
        validator/latency/new_payload: 1000000000
      error:
        sequencer/latency/get_payload: 1500000000
        validator/latency/new_payload: 1500000000
    variables:
      - type: payload
        values:
          - base-mainnet-simulation
          - storage-create-full-block
          - storage-update-full-block
          - storage-churn-full-block
      - type: node_type
        values:
          - geth
      - type: node_args
        value: "--db.engine=treedb"
      - type: num_blocks
        value: 10
      - type: gas_limit
        values:
          - 25000000
